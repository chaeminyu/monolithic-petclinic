# Pet Clinic ì„œë¹„ìŠ¤ ë¶„ë¦¬ ì‹¤ìŠµ ê°€ì´ë“œ (ê°„ì†Œí™”)
## ğŸ“‹ ì‹¤ìŠµ ëª©í‘œ: ëª¨ë†€ë¦¬ìŠ¤ì—ì„œ Customer Service ë¶„ë¦¬

---

## ğŸ¯ ì‹¤ìŠµ ê°œìš”

### ëª©í‘œ
**ì„œë¹„ìŠ¤ ë¶„ë¦¬ì—ë§Œ ì§‘ì¤‘**: ë³µì¡í•œ REST API ë³€í™˜ ì—†ì´, ê¸°ì¡´ Thymeleaf UIë¥¼ ìœ ì§€í•˜ë©´ì„œ ë…ë¦½ì ì¸ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬

### ìµœì¢… ì•„í‚¤í…ì²˜
```
Before (ëª¨ë†€ë¦¬ì‹):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Monolithic Pet Clinic         â”‚
â”‚        Port: 8080               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

After (ë¶„ë¦¬):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Customer Service â”‚  â”‚   Monolith      â”‚
â”‚   Port: 8081     â”‚  â”‚   Port: 8080    â”‚
â”‚ (Owner + Pet)    â”‚  â”‚ (Vet + Visit)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Phase 1: Customer Service ë¶„ë¦¬

### Step 1: í˜„ì¬ êµ¬ì¡° íŒŒì•…

```bash
# monolithì—ì„œ Customer ê´€ë ¨ íŒŒì¼ í™•ì¸
find monolith/src -name "*Owner*" -o -name "*Pet*" | grep -v test
```

**ë³µì‚¬í•  íŒŒì¼ ëª©ë¡:**
- Model: Owner.java, Pet.java, PetType.java + Base í´ë˜ìŠ¤ë“¤
- Repository: OwnerRepository.java, PetRepository.java  
- Controller: OwnerController.java, PetController.java, PetForm.java
- Service: PetFormValidator.java
- Templates: owners/, pets/ í´ë” ì „ì²´

### Step 2: ë””ë ‰í† ë¦¬ ìƒì„± ë° íŒŒì¼ ë³µì‚¬

```bash
# 1. ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
mkdir -p customer-service/src/main/java/org/springframework/samples/petclinic/customer/{model,db,controller,service}
mkdir -p customer-service/src/main/resources/{templates/owners,templates/pets,templates/fragments}

# 2. Model íŒŒì¼ ë³µì‚¬
cp monolith/src/main/java/org/springframework/samples/petclinic/model/{BaseEntity,NamedEntity,Person,Owner,Pet,PetType}.java \
   customer-service/src/main/java/org/springframework/samples/petclinic/customer/model/

# 3. Repository íŒŒì¼ ë³µì‚¬
cp monolith/src/main/java/org/springframework/samples/petclinic/db/{Owner,Pet}Repository.java \
   customer-service/src/main/java/org/springframework/samples/petclinic/customer/db/

# 4. Controller íŒŒì¼ ë³µì‚¬  
cp monolith/src/main/java/org/springframework/samples/petclinic/controller/{Owner,Pet}Controller.java \
   customer-service/src/main/java/org/springframework/samples/petclinic/customer/controller/
cp monolith/src/main/java/org/springframework/samples/petclinic/controller/PetForm.java \
   customer-service/src/main/java/org/springframework/samples/petclinic/customer/controller/

# 5. Service íŒŒì¼ ë³µì‚¬
cp monolith/src/main/java/org/springframework/samples/petclinic/service/PetFormValidator.java \
   customer-service/src/main/java/org/springframework/samples/petclinic/customer/service/

# 6. Template íŒŒì¼ ë³µì‚¬
cp -r monolith/src/main/resources/templates/owners/* customer-service/src/main/resources/templates/owners/
cp -r monolith/src/main/resources/templates/pets/* customer-service/src/main/resources/templates/pets/  
cp -r monolith/src/main/resources/templates/fragments/* customer-service/src/main/resources/templates/fragments/
```

### Step 3: ìƒˆ íŒŒì¼ ìƒì„±

#### 1. build.gradle
```gradle
plugins {
    id 'java'
    id 'org.springframework.boot' version '2.7.18'
    id 'io.spring.dependency-management' version '1.1.4'
}

group = 'org.springframework.samples'
version = '1.0.0'
sourceCompatibility = '17'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-validation'
    runtimeOnly 'com.h2database:h2'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

tasks.named('test') {
    useJUnitPlatform()
}
```

#### 2. application.yml  
```yaml
server:
  port: 8081

spring:
  application:
    name: customer-service
    
  thymeleaf:
    cache: false
    
  datasource:
    url: jdbc:h2:mem:customerdb
    driver-class-name: org.h2.Driver
    username: sa
    password:
    
  h2:
    console:
      enabled: true
      
  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: true
```

#### 3. CustomerServiceApplication.java
```java
package org.springframework.samples.petclinic.customer;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class CustomerServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(CustomerServiceApplication.class, args);
    }
}
```

#### 4. CustomerService.java (ClinicServiceì—ì„œ Customer ë¶€ë¶„ë§Œ ë¶„ë¦¬)
```java
package org.springframework.samples.petclinic.customer.service;

import org.springframework.samples.petclinic.customer.db.OwnerRepository;
import org.springframework.samples.petclinic.customer.db.PetRepository;
import org.springframework.samples.petclinic.customer.model.Owner;
import org.springframework.samples.petclinic.customer.model.Pet;
import org.springframework.samples.petclinic.customer.model.PetType;
import org.springframework.stereotype.Service;

import java.util.Collection;
import java.util.List;

@Service
public class CustomerService {

    private final OwnerRepository owners;
    private final PetRepository pets;

    public CustomerService(OwnerRepository owners, PetRepository pets) {
        this.owners = owners;
        this.pets = pets;
    }

    public Collection<Owner> findOwnersByLastName(String lastName) {
        return owners.findByLastName(lastName);
    }

    public Owner findOwnerById(int ownerId) {
        return owners.findById(ownerId);
    }

    public void saveOwner(Owner owner) {
        owners.save(owner);
    }

    public Pet findPetById(int petId) {
        return pets.findById(petId);
    }

    public List<PetType> findPetTypes() {
        return pets.findPetTypes();
    }

    public void savePet(Pet pet) {
        pets.save(pet);
    }
}
```

### Step 4: íŒ¨í‚¤ì§€ ê²½ë¡œ ìˆ˜ì •

ë³µì‚¬í•œ ëª¨ë“  Java íŒŒì¼ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •:

```java
// ë³€ê²½ ì „
package org.springframework.samples.petclinic.model;
package org.springframework.samples.petclinic.db;
package org.springframework.samples.petclinic.controller;
package org.springframework.samples.petclinic.service;

// ë³€ê²½ í›„  
package org.springframework.samples.petclinic.customer.model;
package org.springframework.samples.petclinic.customer.db;
package org.springframework.samples.petclinic.customer.controller;
package org.springframework.samples.petclinic.customer.service;
```

**Import ë¬¸ë„ í•¨ê»˜ ìˆ˜ì •:**
```java
// Controllerì—ì„œ Service ì˜ì¡´ì„± ë³€ê²½
// ë³€ê²½ ì „
import org.springframework.samples.petclinic.service.ClinicService;

// ë³€ê²½ í›„
import org.springframework.samples.petclinic.customer.service.CustomerService;
```

### Step 5: ì‹¤í–‰ ë° í…ŒìŠ¤íŠ¸

```bash
# 1. Monolith ì‹¤í–‰ (ê¸°ì¡´)
cd monolith
./gradlew bootRun
# â†’ http://localhost:8080

# 2. Customer Service ì‹¤í–‰ (ìƒˆë¡œìš´)  
cd customer-service
./gradlew bootRun
# â†’ http://localhost:8081
```

**í…ŒìŠ¤íŠ¸:**
1. `http://localhost:8080` - ê¸°ì¡´ ëª¨ë†€ë¦¬ìŠ¤ (ì „ì²´ ê¸°ëŠ¥)
2. `http://localhost:8081` - Customer Service (Owner/Petë§Œ)

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Customer Serviceê°€ 8081 í¬íŠ¸ì—ì„œ ë…ë¦½ ì‹¤í–‰ë¨
- [ ] Owner ê´€ë¦¬ ê¸°ëŠ¥ì´ ì •ìƒ ë™ì‘í•¨
- [ ] Pet ê´€ë¦¬ ê¸°ëŠ¥ì´ ì •ìƒ ë™ì‘í•¨  
- [ ] Thymeleaf UIê°€ ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ í‘œì‹œë¨
- [ ] ë³„ë„ H2 ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©í•¨
- [ ] ê¸°ì¡´ ëª¨ë†€ë¦¬ìŠ¤(8080)ë„ ì •ìƒ ë™ì‘í•¨

---

## ğŸ¯ í•µì‹¬ ì„±ê³¼

1. **ì„œë¹„ìŠ¤ ë¶„ë¦¬ ì™„ë£Œ**: Owner&Pet ë„ë©”ì¸ì„ ë…ë¦½ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬
2. **UI ìœ ì§€**: ë³µì¡í•œ API ë³€í™˜ ì—†ì´ ê¸°ì¡´ Thymeleaf í…œí”Œë¦¿ ê·¸ëŒ€ë¡œ ì‚¬ìš©
3. **ë…ë¦½ ì‹¤í–‰**: ì„œë¡œ ë‹¤ë¥¸ í¬íŠ¸, ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë…ë¦½ ìš´ì˜
4. **ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜**: ê¸°ì¡´ ëª¨ë†€ë¦¬ìŠ¤ë¥¼ ìœ ì§€í•˜ë©´ì„œ ìƒˆ ì„œë¹„ìŠ¤ ì¶”ê°€

**ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰** ì²« ë²ˆì§¸ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!